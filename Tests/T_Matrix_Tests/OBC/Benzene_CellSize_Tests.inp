&GLOBAL
   ! the project name is made part of most output files... useful to keep order 
   PROJECT Benzene_Cutoff_Tests
   ! various runtypes (energy, geo_opt, etc.) available.
      RUN_TYPE ENERGY
   ! amount of information printed to output
   IOLEVEL  MEDIUM
   &PRINT
  	SPHERICAL_HARMONICS 5
  &END PRINT
&END GLOBAL
&FORCE_EVAL
   ! the electronic structure part of CP2K is named Quickstep
   METHOD Quickstep
   &DFT
      ! basis sets and pseudopotential files can be found in cp2k/data
       BASIS_SET_FILE_NAME HFX_BASIS
      POTENTIAL_FILE_NAME GTH_POTENTIALS

      ! Charge and multiplicity
      CHARGE 0
      MULTIPLICITY 1

      &MGRID
         ! PW cutoff ... depends on the element (basis) too small cutoffs lead to the eggbox effect.
         ! certain calculations (e.g. geometry optimization, vibrational frequencies,
         ! NPT and cell optimizations, need higher cutoffs)
         CUTOFF 400
         REL_CUTOFF 60
         NGRIDS 5
      &END

      &QS
         ! use the GPW method (i.e. pseudopotential based calculations with the Gaussian and Plane Waves scheme).
         METHOD GPW
         ! default threshold for numerics ~ roughly numerical accuracy of the total energy per electron,
         ! sets reasonable values for all other thresholds.
         EPS_DEFAULT              1.0E-12
      	 EPS_PGF_ORB              1.0E-32
         EPS_FILTER_MATRIX        0.0E+0
         ! used for MD, the method used to generate the initial guess.
         EXTRAPOLATION ASPC
      &END

      &POISSON
      	PERIODIC NONE
      	PSOLVER WAVELET
    &END

&PRINT
         ! at the end of the SCF procedure generate cube files of the density
         &E_DENSITY_CUBE OFF
         &END E_DENSITY_CUBE
         &AO_MATRICES ON
    	ADD_LAST SYMBOLIC
    	NDIGITS 15
    	KOHN_SHAM_MATRIX .TRUE.
    	OVERLAP .TRUE.
    	FILENAME =KSHamiltonian
    	&END AO_MATRICES
         ! compute eigenvalues and homo-lumo gap 
         &MO_CUBES ON
            NLUMO 4
            NHOMO 4
            WRITE_CUBE .FALSE.
            &EACH
               MD 10
            &END
         &END
      &END
      ! use the OT METHOD for robust and efficient SCF, suitable for all non-metallic systems.
      &SCF
         SCF_GUESS RESTART ! can be used to RESTART an interrupted calculation
         MAX_SCF 1
         EPS_SCF 1.0E-8 ! accuracy of the SCF procedure, for OT typically 1.0E-6 - 1.0E-7, for diagonalization may have to be smaller
         &OT
            ! an accurate preconditioner suitable also for larger systems
            PRECONDITIONER FULL_SINGLE_INVERSE
            ! the most robust choice (DIIS might sometimes be faster, but not as stable).
            MINIMIZER CG
         &END OT
         &OUTER_SCF ! repeat the inner SCF cycle 10 times
            MAX_SCF 1
            EPS_SCF 1.0E-8 ! must match the above
         &END
         ! do not store the wfn during MD
         &PRINT
            &RESTART ON
            &END
         &END
      &END SCF
    #These are the coefficients used for B3LYP using VWN5, this is recommended but doesn't match the default Gaussian definition
    &XC
    DENSITY_CUTOFF     1.0000000000000000E-10
       GRADIENT_CUTOFF     1.0000000000000000E-10 

       TAU_CUTOFF     1.0000000000000000E-10
      &XC_FUNCTIONAL
       &GGA_C_LYP
         SCALE 0.81
       &END
       &GGA_X_B88
         SCALE 0.72
       &END
       &LDA_C_VWN_RPA
         SCALE 0.19
       &END
       &XALPHA
         SCALE_X 0.08
       &END
      &END XC_FUNCTIONAL
      &XC_GRID
      	USE_FINER_GRID TRUE
      &END
      &HF
        &SCREENING
          ! needs a good (GGA) initial guess 
          ! screening on the product between maximum of density matrix elements and ERI
          SCREEN_ON_INITIAL_P TRUE
        &END
        &MEMORY
          MAX_MEMORY  40000
        &END
        FRACTION 0.20
        &INTERACTION_POTENTIAL
      	POTENTIAL_TYPE TRUNCATED
      	CUTOFF_RADIUS 5.5
      	T_C_G_DATA /home/max/cp2k-2022.2/data/t_c_g.dat
      	&END INTERACTION_POTENTIAL
      &END
    &END XC
   &END DFT
   ! description of the system
   &SUBSYS
      &CELL
         ! unit cells that are orthorhombic are more efficient with CP2K
	ABC 20 20 20
      &END CELL

      ! atom coordinates can be in the &COORD section,
      ! or provided as an external file.
&TOPOLOGY
         COORD_FILE_NAME Benzene_opt.xyz
         COORD_FILE_FORMAT XYZ
      &END
      &KIND H
      BASIS_SET TZV2P-GTH
      POTENTIAL GTH-BLYP-q1
    &END KIND
    &KIND C
      BASIS_SET TZV2P-GTH
      POTENTIAL GTH-BLYP-q4
    &END KIND    
   &END SUBSYS
&END FORCE_EVAL
